<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>main.py</title>
  <link rel="stylesheet" href="../../pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>main.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <h3>Part 1:</h3>
<p>&mdash; Day 7: Some Assembly Required &mdash;</p>
<p>This year, Santa brought little Bobby Tables a set of wires and bitwise logic
gates! Unfortunately, little Bobby is a little under the recommended age range,
and he needs help assembling the circuit.</p>
<p>Each wire has an identifier (some lowercase letters) and can carry a 16-bit
signal (a number from <code>0</code> to <code>65535</code>). A signal is provided to each wire by a
gate, another wire, or some specific value. Each wire can only get a signal from
one source, but can provide its signal to multiple destinations. A gate provides
no signal until all of its inputs have a signal.</p>
<p>The included instructions booklet describes how to connect the parts together:
<code>x AND y -&gt; z</code> means to connect wires <code>x</code> and <code>y</code> to an AND gate, and then
connect its output to wire <code>z</code>.</p>
<p>For example:</p>
<ul>
<li>
<p><code>123 -&gt; x</code> means that the signal <code>123</code> is provided to wire <code>x</code>.</p>
</li>
<li>
<p><code>x AND y -&gt; z</code> meansthat the bitwise AND of wire <code>x</code> and wire <code>y</code> is provided
  to wire <code>z</code>.</p>
</li>
<li>
<p><code>p LSHIFT 2 -&gt; q</code> means that the value from wire <code>p</code> is left-shifted by <code>2</code>
  and then provided to wire <code>q</code>.</p>
</li>
<li>
<p><code>NOT e -&gt; f</code> means that the bitwise complement of the value from wire <code>e</code> is
  provided to wire <code>f</code>.</p>
</li>
</ul>
<p>Other possible gates include <code>OR</code> (bitwise OR) and <code>RSHIFT</code> (right-shift). If,
for some reason, you&rsquo;d like to <strong>emulate</strong> the circuit instead, almost all
programming languages (for example, C, JavaScript, or Python) provide operators
for these gates.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">re</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">test_part1</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>For example, here is a simple circuit:</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">simple_circuit</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">        123 -&gt; x</span>
<span class="s2">        456 -&gt; y</span>
<span class="s2">        x AND y -&gt; d</span>
<span class="s2">        x OR y -&gt; e</span>
<span class="s2">        x LSHIFT 2 -&gt; f</span>
<span class="s2">        y RSHIFT 2 -&gt; g</span>
<span class="s2">        NOT x -&gt; h</span>
<span class="s2">        NOT y -&gt; i&quot;&quot;&quot;</span>  <span class="c1"># pycco plz</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>After it is run, these are the signals on the wires:</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">expected_signals</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;d&quot;</span><span class="p">:</span> <span class="mi">72</span><span class="p">,</span>
        <span class="s2">&quot;e&quot;</span><span class="p">:</span> <span class="mi">507</span><span class="p">,</span>
        <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="mi">492</span><span class="p">,</span>
        <span class="s2">&quot;g&quot;</span><span class="p">:</span> <span class="mi">114</span><span class="p">,</span>
        <span class="s2">&quot;h&quot;</span><span class="p">:</span> <span class="mi">65412</span><span class="p">,</span>
        <span class="s2">&quot;i&quot;</span><span class="p">:</span> <span class="mi">65079</span><span class="p">,</span>
        <span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
        <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">456</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="n">initial_values</span><span class="p">,</span> <span class="n">unresolved_gates</span> <span class="o">=</span> <span class="n">parse_input</span><span class="p">(</span><span class="n">simple_circuit</span><span class="p">)</span>
    <span class="n">wire_values</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">initial_values</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">resolve_wire_values</span><span class="p">(</span><span class="n">unresolved_gates</span><span class="p">,</span> <span class="n">wire_values</span><span class="p">)</span> <span class="o">==</span> <span class="n">expected_signals</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>In little Bobby&rsquo;s kit&rsquo;s instructions booklet (provided as your puzzle input),
what signal is ultimately provided to <strong>wire <code>a</code></strong>?</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <h3><span id="part-1-solution:" href="part-1-solution:"> Part 1 Solution: </span></h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <h3>Initial Thoughts</h3>
<p>The trickiest part of this problem that jumps out at me immediately is the fact
that these wire and gate descriptions can come in any order. Since gates can&rsquo;t
be resolved until the values of the input wires are known, it is possible for
gates to be listed in the input before it is possible to know its input wires&rsquo;
values yet. This means that all gate descriptions will have to be parsed out
beforehand and then resolved in the appropriate order.</p>
<p>This circuit resolution algorithm could be done in a pure brute force way, but
I&rsquo;d like to find an easy way to make it faster and simpler to reason about. The
first thing to come to mind is having two sets of wires: the set that are known
about but don&rsquo;t have a value yet, and the set that have values already. Then,
if part of a gate&rsquo;s information is the set of wires that are needed as inputs,
a single set operation can be done to see if all required wires have values yet.</p>
<h3>Types</h3>
<p>Now, I want to come up with some types for this code. The main three entities
in the problem description are wires, signals, and gates.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>Wire names are just lowercase strings</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">Wire</span> <span class="o">=</span> <span class="nb">str</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>Values are integers</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">Value</span> <span class="o">=</span> <span class="nb">int</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>Wire values are maintained in a dictionary</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">WireValues</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Wire</span><span class="p">,</span> <span class="n">Value</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>Values are 16 bit integers, so the maximum possible size is 2^16 - 1</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">MAX_VALUE</span><span class="p">:</span> <span class="n">Value</span> <span class="o">=</span> <span class="mi">2</span><span class="o">**</span><span class="mi">16</span> <span class="o">-</span> <span class="mi">1</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>Gates have a set of input wires, one output wire, and a way of resolving the
input values into the output values. Inputs can be provided as a wire name
that needs to be resolved or as a preset static value.</p>
<p>This abstract base class cannot be used directly. Subclasses must be made
for each type of gate which implement the <code>resolve_ouput_value()</code> method.</p>
<blockquote>
<p>This got a little nastier than I&rsquo;d hoped since I needed these <code>Gate</code>
objects to be hashable in the logic below. This required the use of frozen
dataclasses and frozen sets. The gate objects themselves should never
change, so that&rsquo;s fine. It just adds more syntactic noise.</p>
</blockquote>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nd">@dataclass</span><span class="p">(</span><span class="n">eq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Gate</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>Note that all gates in the problem don&rsquo;t care about wire order, so there
is no need to remember the wire order.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">wire_inputs</span><span class="p">:</span> <span class="nb">frozenset</span><span class="p">[</span><span class="n">Wire</span><span class="p">]</span>
    <span class="n">static_inputs</span><span class="p">:</span> <span class="nb">frozenset</span><span class="p">[</span><span class="n">Value</span><span class="p">]</span>
    <span class="n">output</span><span class="p">:</span> <span class="n">Wire</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>This represents two wires being connected</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">resolve_output_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">:</span> <span class="n">Value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Value</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>


<span class="nd">@dataclass</span><span class="p">(</span><span class="n">eq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">ConnectionGate</span><span class="p">(</span><span class="n">Gate</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">resolve_output_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">:</span> <span class="n">Value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Value</span><span class="p">:</span>
        <span class="p">(</span><span class="n">a</span><span class="p">,)</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">return</span> <span class="n">a</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>This represents the AND gate</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nd">@dataclass</span><span class="p">(</span><span class="n">eq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">AndGate</span><span class="p">(</span><span class="n">Gate</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">resolve_output_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">:</span> <span class="n">Value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Value</span><span class="p">:</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">&amp;</span> <span class="n">b</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>This represents the OR gate</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nd">@dataclass</span><span class="p">(</span><span class="n">eq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">OrGate</span><span class="p">(</span><span class="n">Gate</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">resolve_output_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">:</span> <span class="n">Value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Value</span><span class="p">:</span>
        <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">|</span> <span class="n">b</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>This represents the LSHIFT gate</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nd">@dataclass</span><span class="p">(</span><span class="n">eq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">LShiftGate</span><span class="p">(</span><span class="n">Gate</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">shift_amount</span><span class="p">:</span> <span class="nb">int</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">resolve_output_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">:</span> <span class="n">Value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Value</span><span class="p">:</span>
        <span class="p">(</span><span class="n">a</span><span class="p">,)</span> <span class="o">=</span> <span class="n">values</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p>Need to mask off the return value in case the value was shifted beyond
the 16 bit limit.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_amount</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">MAX_VALUE</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p>This represents the RSHIFT gate</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nd">@dataclass</span><span class="p">(</span><span class="n">eq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">RShiftGate</span><span class="p">(</span><span class="n">Gate</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">shift_amount</span><span class="p">:</span> <span class="nb">int</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">resolve_output_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">:</span> <span class="n">Value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Value</span><span class="p">:</span>
        <span class="p">(</span><span class="n">a</span><span class="p">,)</span> <span class="o">=</span> <span class="n">values</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">shift_amount</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <p>This represents the NOT gate</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nd">@dataclass</span><span class="p">(</span><span class="n">eq</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">NotGate</span><span class="p">(</span><span class="n">Gate</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">def</span> <span class="nf">resolve_output_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">:</span> <span class="n">Value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Value</span><span class="p">:</span>
        <span class="p">(</span><span class="n">a</span><span class="p">,)</span> <span class="o">=</span> <span class="n">values</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p>Bitwise NOT in Python is weird since all ints are signed with
arbitrary precision. Using subtraction as a workaround.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">return</span> <span class="n">MAX_VALUE</span> <span class="o">-</span> <span class="n">a</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <p>This parser helper function separates inputs into wire and static value
sets.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">classify_inputs</span><span class="p">(</span><span class="o">*</span><span class="n">inputs</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">frozenset</span><span class="p">[</span><span class="n">Wire</span><span class="p">],</span> <span class="nb">frozenset</span><span class="p">[</span><span class="n">Value</span><span class="p">]]:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">wire_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">value_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">for</span> <span class="nb">input</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">input</span><span class="o">.</span><span class="n">isdecimal</span><span class="p">():</span>
            <span class="n">value_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">input</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wire_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">wire_set</span><span class="p">),</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">value_set</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <p>This function takes in a line from the input and parses it into the
appropriate value. All input lines are either values being assigned directly
to wires or gate descriptions.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">parse_line</span><span class="p">(</span><span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Wire</span><span class="p">,</span> <span class="n">Value</span><span class="p">]</span> <span class="o">|</span> <span class="n">Gate</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">wire</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;[a-z]+&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;\d+&quot;</span>
    <span class="nb">input</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;(?:</span><span class="si">{</span><span class="n">wire</span><span class="si">}</span><span class="s2">)|(?:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">)&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      <p>Match initial values being assigned directly to wires</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">) -&gt; (</span><span class="si">{</span><span class="n">wire</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="n">value</span><span class="p">,</span> <span class="n">wire</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">wire</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <p>Match wire connections</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">input</span><span class="si">}</span><span class="s2">) -&gt; (</span><span class="si">{</span><span class="n">wire</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="n">input1</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
        <span class="n">wire_inputs</span><span class="p">,</span> <span class="n">static_inputs</span> <span class="o">=</span> <span class="n">classify_inputs</span><span class="p">(</span><span class="n">input1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ConnectionGate</span><span class="p">(</span>
            <span class="n">wire_inputs</span><span class="o">=</span><span class="n">wire_inputs</span><span class="p">,</span> <span class="n">static_inputs</span><span class="o">=</span><span class="n">static_inputs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output</span>
        <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <p>Match AND gates</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">input</span><span class="si">}</span><span class="s2">) AND (</span><span class="si">{</span><span class="nb">input</span><span class="si">}</span><span class="s2">) -&gt; (</span><span class="si">{</span><span class="n">wire</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
        <span class="n">wire_inputs</span><span class="p">,</span> <span class="n">static_inputs</span> <span class="o">=</span> <span class="n">classify_inputs</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">AndGate</span><span class="p">(</span>
            <span class="n">wire_inputs</span><span class="o">=</span><span class="n">wire_inputs</span><span class="p">,</span> <span class="n">static_inputs</span><span class="o">=</span><span class="n">static_inputs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output</span>
        <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <p>Match OR gates</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">input</span><span class="si">}</span><span class="s2">) OR (</span><span class="si">{</span><span class="nb">input</span><span class="si">}</span><span class="s2">) -&gt; (</span><span class="si">{</span><span class="n">wire</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
        <span class="n">wire_inputs</span><span class="p">,</span> <span class="n">static_inputs</span> <span class="o">=</span> <span class="n">classify_inputs</span><span class="p">(</span><span class="n">input1</span><span class="p">,</span> <span class="n">input2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">OrGate</span><span class="p">(</span>
            <span class="n">wire_inputs</span><span class="o">=</span><span class="n">wire_inputs</span><span class="p">,</span> <span class="n">static_inputs</span><span class="o">=</span><span class="n">static_inputs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output</span>
        <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      <p>Match LSHIFT gates</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">input</span><span class="si">}</span><span class="s2">) LSHIFT (</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">) -&gt; (</span><span class="si">{</span><span class="n">wire</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="n">input1</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
        <span class="n">wire_inputs</span><span class="p">,</span> <span class="n">static_inputs</span> <span class="o">=</span> <span class="n">classify_inputs</span><span class="p">(</span><span class="n">input1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">LShiftGate</span><span class="p">(</span>
            <span class="n">wire_inputs</span><span class="o">=</span><span class="n">wire_inputs</span><span class="p">,</span>
            <span class="n">static_inputs</span><span class="o">=</span><span class="n">static_inputs</span><span class="p">,</span>
            <span class="n">shift_amount</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">),</span>
            <span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
        <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      <p>Match RSHIFT gates</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;(</span><span class="si">{</span><span class="nb">input</span><span class="si">}</span><span class="s2">) RSHIFT (</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">) -&gt; (</span><span class="si">{</span><span class="n">wire</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="n">input1</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
        <span class="n">wire_inputs</span><span class="p">,</span> <span class="n">static_inputs</span> <span class="o">=</span> <span class="n">classify_inputs</span><span class="p">(</span><span class="n">input1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">RShiftGate</span><span class="p">(</span>
            <span class="n">wire_inputs</span><span class="o">=</span><span class="n">wire_inputs</span><span class="p">,</span>
            <span class="n">static_inputs</span><span class="o">=</span><span class="n">static_inputs</span><span class="p">,</span>
            <span class="n">shift_amount</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">value</span><span class="p">),</span>
            <span class="n">output</span><span class="o">=</span><span class="n">output</span><span class="p">,</span>
        <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      <p>Match NOT gates</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">m</span> <span class="o">:=</span> <span class="n">re</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="sa">rf</span><span class="s2">&quot;NOT (</span><span class="si">{</span><span class="nb">input</span><span class="si">}</span><span class="s2">) -&gt; (</span><span class="si">{</span><span class="n">wire</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">line</span><span class="p">):</span>
        <span class="n">input1</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
        <span class="n">wire_inputs</span><span class="p">,</span> <span class="n">static_inputs</span> <span class="o">=</span> <span class="n">classify_inputs</span><span class="p">(</span><span class="n">input1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">NotGate</span><span class="p">(</span>
            <span class="n">wire_inputs</span><span class="o">=</span><span class="n">wire_inputs</span><span class="p">,</span> <span class="n">static_inputs</span><span class="o">=</span><span class="n">static_inputs</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output</span>
        <span class="p">)</span>

    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Could not parse line: &#39;</span><span class="si">{</span><span class="n">line</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-45'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-45'>#</a>
      </div>
      <p>Parse the problem input into a list of initial wire values and a list of
logic gate objects.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">parse_input</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Wire</span><span class="p">,</span> <span class="n">Value</span><span class="p">]],</span> <span class="nb">list</span><span class="p">[</span><span class="n">Gate</span><span class="p">]]:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-46'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-46'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">initial_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">unresolved_gates</span> <span class="o">=</span> <span class="p">[]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-47'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-47'>#</a>
      </div>
      <p>Parse the input into initial values and gate descriptions</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">input</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">():</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">parse_line</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Gate</span><span class="p">):</span>
            <span class="n">unresolved_gates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">initial_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">initial_values</span><span class="p">,</span> <span class="n">unresolved_gates</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-48'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-48'>#</a>
      </div>
      <p>Resolve all the gates in a valid order while updating the wire value
dictionary with the gate outputs. Once all gates have been resolved, return
the final resulting wire value dictionary.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">resolve_wire_values</span><span class="p">(</span><span class="n">gates</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Gate</span><span class="p">],</span> <span class="n">wire_values</span><span class="p">:</span> <span class="n">WireValues</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">WireValues</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-49'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-49'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">unresolved_gates</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">gates</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-50'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-50'>#</a>
      </div>
      <p>Keep looping until all gates are resolved</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">unresolved_gates</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">wire_values</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-51'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-51'>#</a>
      </div>
      <p>Find a gate whose input wires all have values</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="k">for</span> <span class="n">gate</span> <span class="ow">in</span> <span class="n">unresolved_gates</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gate</span><span class="o">.</span><span class="n">wire_inputs</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="n">wire_values</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">wire_values</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">unresolved_gates</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No gates found with all resolved inputs&quot;</span><span class="p">)</span>

        <span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Resolving gate </span><span class="si">{</span><span class="n">gate</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-52'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-52'>#</a>
      </div>
      <p>Get the gate&rsquo;s resolved value</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">resolved_value</span> <span class="o">=</span> <span class="n">gate</span><span class="o">.</span><span class="n">resolve_output_value</span><span class="p">(</span>
            <span class="o">*</span><span class="p">(</span><span class="n">wire_values</span><span class="p">[</span><span class="n">wire</span><span class="p">]</span> <span class="k">for</span> <span class="n">wire</span> <span class="ow">in</span> <span class="n">gate</span><span class="o">.</span><span class="n">wire_inputs</span><span class="p">),</span> <span class="o">*</span><span class="n">gate</span><span class="o">.</span><span class="n">static_inputs</span>
        <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-53'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-53'>#</a>
      </div>
      <p>Record the gate&rsquo;s resolved value to its output wire</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">wire_values</span><span class="p">[</span><span class="n">gate</span><span class="o">.</span><span class="n">output</span><span class="p">]</span> <span class="o">=</span> <span class="n">resolved_value</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-54'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-54'>#</a>
      </div>
      <p>Remove the gate from the unresolved list</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">unresolved_gates</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">gate</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">wire_values</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-55'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-55'>#</a>
      </div>
      <p>Resolve all wire values according to the problem input&rsquo;s initial values and
gate descriptions. Return the final value on the <code>a</code> wire.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">part1</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Value</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-56'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-56'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">initial_values</span><span class="p">,</span> <span class="n">unresolved_gates</span> <span class="o">=</span> <span class="n">parse_input</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-57'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-57'>#</a>
      </div>
      <p>Create the wire value dictionary with the parsed initial values</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">wire_values</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">initial_values</span><span class="p">)</span>

    <span class="n">wire_values</span> <span class="o">=</span> <span class="n">resolve_wire_values</span><span class="p">(</span><span class="n">unresolved_gates</span><span class="p">,</span> <span class="n">wire_values</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">wire_values</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-58'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-58'>#</a>
      </div>
      <h3>Part 2:</h3>
<p>&mdash; Part Two &mdash;</p>
<p>Now, take the signal you got on wire <code>a</code>, override wire <code>b</code> to that signal, and
reset the other wires (including wire <code>a</code>). What new signal is ultimately
provided to wire <code>a</code>?</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-59'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-59'>#</a>
      </div>
      <h3><span id="part-2-solution:" href="part-2-solution:"> Part 2 Solution: </span></h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-60'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-60'>#</a>
      </div>
      <p>Resolve all wire values according to the problem input&rsquo;s initial values and
gate descriptions. Then, repeat the resolution with wire <code>b</code> set to the
value that <code>a</code> was resolved to in the initial resolution. Return the value
of <code>a</code> after the second resolution.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">part2</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Value</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-61'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-61'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">initial_values</span><span class="p">,</span> <span class="n">unresolved_gates</span> <span class="o">=</span> <span class="n">parse_input</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-62'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-62'>#</a>
      </div>
      <p>Do first wire value resolution</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">first_wire_values</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">initial_values</span><span class="p">)</span>
    <span class="n">first_wire_values</span> <span class="o">=</span> <span class="n">resolve_wire_values</span><span class="p">(</span><span class="n">unresolved_gates</span><span class="p">,</span> <span class="n">first_wire_values</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-63'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-63'>#</a>
      </div>
      <p>Recreate initial wire values with new <code>b</code> value set to the old <code>a</code> value</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">second_wire_values</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">initial_values</span><span class="p">)</span>
    <span class="n">second_wire_values</span><span class="p">[</span><span class="s2">&quot;b&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">first_wire_values</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-64'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-64'>#</a>
      </div>
      <p>Resolve again and return</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">second_wire_values</span> <span class="o">=</span> <span class="n">resolve_wire_values</span><span class="p">(</span><span class="n">unresolved_gates</span><span class="p">,</span> <span class="n">second_wire_values</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">second_wire_values</span><span class="p">[</span><span class="s2">&quot;a&quot;</span><span class="p">]</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>

    <span class="n">puzzle_input</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-65'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-65'>#</a>
      </div>
      <p>Print out part 1 solution</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Part 1:&quot;</span><span class="p">,</span> <span class="n">part1</span><span class="p">(</span><span class="n">puzzle_input</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-66'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-66'>#</a>
      </div>
      <p>Print out part 2 solution</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Part 2:&quot;</span><span class="p">,</span> <span class="n">part2</span><span class="p">(</span><span class="n">puzzle_input</span><span class="p">))</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
