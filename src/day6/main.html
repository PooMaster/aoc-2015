<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>main.py</title>
  <link rel="stylesheet" href="../../pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>main.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <h3>Part 1:</h3>
<p>&mdash; Day 6: Probably a Fire Hazard &mdash;</p>
<p>Because your neighbors keep defeating you in the holiday house decorating
contest year after year, you&rsquo;ve decided to deploy one million lights in a
1000x1000 grid.</p>
<p>Furthermore, because you&rsquo;ve been especially nice this year, Santa has mailed you
instructions on how to display the ideal lighting configuration.</p>
<p>Lights in your grid are numbered from 0 to 999 in each direction; the lights at
each corner are at <code>0,0</code>, <code>0,999</code>, <code>999,999</code>, and <code>999,0</code>. The instructions
include whether to <code>turn on</code>, <code>turn off</code>, or <code>toggle</code> various inclusive ranges
given as coordinate pairs. Each coordinate pair represents opposite corners of a
rectangle, inclusive; a coordinate pair like <code>0,0 through 2,2</code> therefore refers
to 9 lights in a 3x3 square. The lights all start turned off.</p>
<p>To defeat your neighbors this year, all you have to do is set up your lights by
doing the instructions Santa sent you in order.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">enum</span> <span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">NamedTuple</span><span class="p">,</span> <span class="n">TypeVar</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>This class represents a location on the problem grid.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">Pos</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">int</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>Grids are a variable type to support using bools in part 1 and ints int part 2.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">T</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s2">&quot;T&quot;</span><span class="p">)</span>
<span class="n">Grid</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Pos</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>Makes and returns a new grid with the given size with all positions in the
same initial state.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">new_grid</span><span class="p">(</span><span class="n">size</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">initial_state</span><span class="p">:</span> <span class="n">T</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Grid</span><span class="p">[</span><span class="n">T</span><span class="p">]:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">size_x</span><span class="p">,</span> <span class="n">size_y</span> <span class="o">=</span> <span class="n">size</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="p">(</span><span class="n">Pos</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="n">initial_state</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">size_x</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="n">size_y</span><span class="p">))</span>
    <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>For example:</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">test_part1</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">lights</span> <span class="o">=</span> <span class="n">new_grid</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="ow">not</span> <span class="n">lit</span> <span class="k">for</span> <span class="n">lit</span> <span class="ow">in</span> <span class="n">lights</span><span class="o">.</span><span class="n">values</span><span class="p">())</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <blockquote>
<p><code>turn on 0,0 through 999,999</code> would turn on (or leave on) every light.</p>
</blockquote>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">perform_instruction</span><span class="p">(</span><span class="s2">&quot;turn on 0,0 through 999,999&quot;</span><span class="p">,</span> <span class="n">lights</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">lit</span> <span class="k">for</span> <span class="n">lit</span> <span class="ow">in</span> <span class="n">lights</span><span class="o">.</span><span class="n">values</span><span class="p">())</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <blockquote>
<p><code>toggle 0,0 through 999,0</code> would toggle the first line of 1000 lights,
turning off the ones that were on, and turning on the ones that were
off.</p>
</blockquote>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">perform_instruction</span><span class="p">(</span><span class="s2">&quot;toggle 0,0 through 999,0&quot;</span><span class="p">,</span> <span class="n">lights</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="ow">not</span> <span class="n">lights</span><span class="p">[</span><span class="n">Pos</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <blockquote>
<p><code>turn off 499,499 through 500,500</code> would turn off (or leave off) the
middle four lights.</p>
</blockquote>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">perform_instruction</span><span class="p">(</span><span class="s2">&quot;turn off 499,499 through 500,500&quot;</span><span class="p">,</span> <span class="n">lights</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="ow">not</span> <span class="n">lights</span><span class="p">[</span><span class="n">Pos</span><span class="p">(</span><span class="mi">499</span><span class="p">,</span> <span class="mi">499</span><span class="p">)],</span>
            <span class="ow">not</span> <span class="n">lights</span><span class="p">[</span><span class="n">Pos</span><span class="p">(</span><span class="mi">499</span><span class="p">,</span> <span class="mi">500</span><span class="p">)],</span>
            <span class="ow">not</span> <span class="n">lights</span><span class="p">[</span><span class="n">Pos</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">499</span><span class="p">)],</span>
            <span class="ow">not</span> <span class="n">lights</span><span class="p">[</span><span class="n">Pos</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">)],</span>
        <span class="p">]</span>
    <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>After following the instructions, <strong>how many lights are lit</strong>?</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <h3><span id="part-1-solution:" href="part-1-solution:"> Part 1 Solution: </span></h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">InstructionKind</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">on</span> <span class="o">=</span> <span class="s2">&quot;turn on&quot;</span>
    <span class="n">off</span> <span class="o">=</span> <span class="s2">&quot;turn off&quot;</span>
    <span class="n">toggle</span> <span class="o">=</span> <span class="s2">&quot;toggle&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">class</span> <span class="nc">Instruction</span><span class="p">(</span><span class="n">NamedTuple</span><span class="p">):</span>
    <span class="n">kind</span><span class="p">:</span> <span class="n">InstructionKind</span>
    <span class="n">x_range</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
    <span class="n">y_range</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>


<span class="n">instruction_pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
    <span class="sa">r</span><span class="s2">&quot;(?P&lt;kind&gt;[\w ]+) (?P&lt;point1&gt;\d+,\d+) through (?P&lt;point2&gt;\d+,\d+)&quot;</span>
<span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>Parse an instruction string into a named tuple.</p>
<pre><code>&gt;&gt;&gt; parse_instruction("turn on 0,0 through 999,999")
Instruction(kind=&lt;InstructionKind.on: 'turn on'&gt;, x_range=range(0, 1000), y_range=range(0, 1000))
</code></pre>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">parse_instruction</span><span class="p">(</span><span class="n">instruction_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Instruction</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">m</span> <span class="o">=</span> <span class="n">instruction_pattern</span><span class="o">.</span><span class="n">fullmatch</span><span class="p">(</span><span class="n">instruction_string</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Could not parse instruction &#39;</span><span class="si">{instruction_string}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;point1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;point2&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>

    <span class="n">min_x</span><span class="p">,</span> <span class="n">max_x</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">x2</span><span class="p">)])</span>
    <span class="n">min_y</span><span class="p">,</span> <span class="n">max_y</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="nb">int</span><span class="p">(</span><span class="n">y1</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y2</span><span class="p">)])</span>

    <span class="k">return</span> <span class="n">Instruction</span><span class="p">(</span>
        <span class="n">kind</span><span class="o">=</span><span class="n">InstructionKind</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="s2">&quot;kind&quot;</span><span class="p">)),</span>
        <span class="n">x_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">min_x</span><span class="p">,</span> <span class="n">max_x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">y_range</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">min_y</span><span class="p">,</span> <span class="n">max_y</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>Follow the instruction to modify the grid in place.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">perform_instruction</span><span class="p">(</span><span class="n">instruction_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">grid</span><span class="p">:</span> <span class="n">Grid</span><span class="p">[</span><span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">instruction</span> <span class="o">=</span> <span class="n">parse_instruction</span><span class="p">(</span><span class="n">instruction_string</span><span class="p">)</span>

    <span class="n">positions</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span>
        <span class="n">Pos</span><span class="o">.</span><span class="n">_make</span><span class="p">,</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">instruction</span><span class="o">.</span><span class="n">x_range</span><span class="p">,</span> <span class="n">instruction</span><span class="o">.</span><span class="n">y_range</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">match</span> <span class="n">instruction</span><span class="o">.</span><span class="n">kind</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">InstructionKind</span><span class="o">.</span><span class="n">on</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="n">grid</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">case</span> <span class="n">InstructionKind</span><span class="o">.</span><span class="n">off</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="n">grid</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">case</span> <span class="n">InstructionKind</span><span class="o">.</span><span class="n">toggle</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="n">grid</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">grid</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      <p>Perform each line of input as an instruction on a 1000 by 1000 grid of
lights and return the number of lights lits at the end.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">part1</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <h3>Part 2:</h3>
<p>&mdash; Part Two &mdash;</p>
<p>You just finish implementing your winning light pattern when you realize you
mistranslated Santa&rsquo;s message from Ancient Nordic Elvish.</p>
<p>The light grid you bought actually has individual brightness controls; each
light can have a brightness of zero or more. The lights all start at zero.</p>
<p>The phrase <code>turn on</code> actually means that you should increase the brightness of
those lights by <code>1</code>.</p>
<p>The phrase <code>turn off</code> actually means that you should decrease the brightness of
those lights by <code>1</code>, to a minimum of zero.</p>
<p>The phrase <code>toggle</code> actually means that you should increase the brightness of
those lights by <code>2</code>.</p>
<p>What is the total brightness of all lights combined after following Santa&rsquo;s
instructions?</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">lights</span> <span class="o">=</span> <span class="n">new_grid</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">instructions</span> <span class="o">=</span> <span class="nb">input</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">instruction</span> <span class="ow">in</span> <span class="n">instructions</span><span class="p">:</span>
        <span class="n">perform_instruction</span><span class="p">(</span><span class="n">instruction</span><span class="p">,</span> <span class="n">lights</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lights</span><span class="o">.</span><span class="n">values</span><span class="p">())</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>For example:</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">test_part2</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">lights</span> <span class="o">=</span> <span class="n">new_grid</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">brightness</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">brightness</span> <span class="ow">in</span> <span class="n">lights</span><span class="o">.</span><span class="n">values</span><span class="p">())</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <blockquote>
<p><code>turn on 0,0 through 0,0</code> would increase the total brightness by <code>1</code>.</p>
</blockquote>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">perform_instruction2</span><span class="p">(</span><span class="s2">&quot;turn on 0,0 through 0,0&quot;</span><span class="p">,</span> <span class="n">lights</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">lights</span><span class="p">[</span><span class="n">Pos</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)]</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">assert</span> <span class="n">total_brightness</span><span class="p">(</span><span class="n">lights</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <blockquote>
<p><code>toggle 0,0 through 999,999</code> would increase the total brightness by <code>2000000</code>.</p>
</blockquote>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">perform_instruction2</span><span class="p">(</span><span class="s2">&quot;toggle 0,0 through 999,999&quot;</span><span class="p">,</span> <span class="n">lights</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">total_brightness</span><span class="p">(</span><span class="n">lights</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2_000_001</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <h3><span id="part-2-solution:" href="part-2-solution:"> Part 2 Solution: </span></h3>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p>Follow the instruction to modify the grid in place, except according to the
part 2 rules this time.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">perform_instruction2</span><span class="p">(</span><span class="n">instruction_string</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">grid</span><span class="p">:</span> <span class="n">Grid</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">instruction</span> <span class="o">=</span> <span class="n">parse_instruction</span><span class="p">(</span><span class="n">instruction_string</span><span class="p">)</span>

    <span class="n">positions</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span>
        <span class="n">Pos</span><span class="o">.</span><span class="n">_make</span><span class="p">,</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">instruction</span><span class="o">.</span><span class="n">x_range</span><span class="p">,</span> <span class="n">instruction</span><span class="o">.</span><span class="n">y_range</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">match</span> <span class="n">instruction</span><span class="o">.</span><span class="n">kind</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">InstructionKind</span><span class="o">.</span><span class="n">on</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="n">grid</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">case</span> <span class="n">InstructionKind</span><span class="o">.</span><span class="n">off</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">grid</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">grid</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="k">case</span> <span class="n">InstructionKind</span><span class="o">.</span><span class="n">toggle</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">positions</span><span class="p">:</span>
                <span class="n">grid</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">2</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p>Returns the total brightness for a grid of lights.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">total_brightness</span><span class="p">(</span><span class="n">lights</span><span class="p">:</span> <span class="n">Grid</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">lights</span><span class="o">.</span><span class="n">values</span><span class="p">())</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p>Perform each line of input as an instruction on a 1000 by 1000 grid of
lights and return the number of lights lits at the end.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">part2</span><span class="p">(</span><span class="nb">input</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="o">...</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">lights</span> <span class="o">=</span> <span class="n">new_grid</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">instructions</span> <span class="o">=</span> <span class="nb">input</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">instruction</span> <span class="ow">in</span> <span class="n">instructions</span><span class="p">:</span>
        <span class="n">perform_instruction2</span><span class="p">(</span><span class="n">instruction</span><span class="p">,</span> <span class="n">lights</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">total_brightness</span><span class="p">(</span><span class="n">lights</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">puzzle_input</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input.txt&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p>Print out part 1 solution</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Part 1:&quot;</span><span class="p">,</span> <span class="n">part1</span><span class="p">(</span><span class="n">puzzle_input</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <p>Print out part 2 solution</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Part 2:&quot;</span><span class="p">,</span> <span class="n">part2</span><span class="p">(</span><span class="n">puzzle_input</span><span class="p">))</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
